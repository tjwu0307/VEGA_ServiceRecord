<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ç¶­å˜‰å…¨çƒç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸ - æœå‹™ç´€éŒ„å–®</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.6/dist/signature_pad.umd.min.js"></script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Microsoft JhengHei', Arial, sans-serif;
      background:white;
    }
    .container {
      width:210mm;
      min-height:297mm;
      margin:0 auto;
      background:white;
      box-sizing:border-box;
      padding:10mm;
    }
    @media print {
      .no-print { display:none !important; }
    }
    .header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .logo { width:80px; }
    .company-info { flex:1; margin-left:10px; }
    .company-name { font-size:20px; font-weight:bold; }
    .form-title { font-size:16px; }
    .contact-info { display:flex; gap:20px; margin-top:8px; }
    .contact-section { font-size:12px; }
    .form-grid {
      display:table;
      width:100%;
      border-collapse:collapse;
      margin-bottom:10px;
    }
    .form-row { display:table-row; }
    .form-cell {
      display:table-cell;
      border:1px solid #333;
      padding:6px;
      vertical-align:middle;
    }
    .form-cell.label { background:#f0f0f0; width:25%; font-weight:bold; text-align:center; }
    .form-cell.input input, .form-cell.input textarea {
      width:100%; border:none; font-size:12px; background:transparent;
    }
    .section-title {
      background:#f0f0f0;
      padding:6px;
      border:1px solid #333;
      border-bottom:none;
      font-weight:bold;
      text-align:left;
      margin-top:10px;
    }
    .section-content {
      border:1px solid #333;
      padding:8px;
      margin-bottom:10px;
    }
    .service-methods {
      display:grid;
      grid-template-columns:repeat(5,1fr);
      gap:6px;
    }
    .checkbox-group { font-size:12px; }
    .product-table {
      width:100%; border-collapse:collapse;
    }
    .product-table th, .product-table td {
      border:1px solid #333; padding:6px; text-align:center; font-size:12px;
    }
    .signature-section {
      display:table; width:100%; border:1px solid #333; margin:10px 0;
    }
    .signature-row { display:table-row; }
    .signature-box {
      display:table-cell; width:33.3%; text-align:center; padding:10px; border-right:1px solid #333; position:relative;
    }
    .signature-box:last-child { border-right:none; }
    .signature-canvas { width:100%; height:80px; border:1px solid #ccc; }
    .signature-controls { position:absolute; top:5px; right:5px; }
    .clear-btn {
      background:#66B3FF; color:white; border:none; padding:4px 8px; cursor:pointer;
    }
    .expense-grid { display:flex; }
    .expense-item { flex:1; border-right:1px solid #333; padding:6px; }
    .expense-item:last-child { border-right:none; }
    .expense-item label { font-weight:bold; font-size:12px; display:block; margin-bottom:4px; }
    .expense-item input { width:100%; border:none; font-size:12px; text-align:center; }
    .copy-info { text-align:center; margin:10px 0; font-size:14px; }
    .submit-section { text-align:center; margin-top:15px; }
    .submit-btn {
      background:#FF5151; color:white; border:none; padding:10px 20px;
      font-weight:bold; border-radius:6px; cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="container" id="pdfContent">
    <div class="header">
      <div class="logo">
        <img src="https://vega-global.com/wp-content/uploads/2024/07/Website-Logo-2048x1833-1-1536x1375.png" width="100%">
      </div>
      <div class="company-info">
        <div class="company-name">ç¶­å˜‰å…¨çƒç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸</div>
        <div class="form-title">æœå‹™ç´€éŒ„å–®</div>
        <div class="contact-info">
          <div class="contact-section">
            ã€å°åŒ—ã€‘æœå‹™å°ˆç·š 02-35182883<br>
            å°åŒ—å¸‚æ¾å±±å€æ°‘ç”Ÿæ±è·¯ä¸‰æ®µ128è™Ÿ14F-1<br>
            Fax:(02)2545-1155
          </div>
          <div class="contact-section">
            ã€å°ä¸­ã€‘æœå‹™å°ˆç·š 02-35182884<br>
            å°ä¸­å¸‚åŒ—ä¸­å€æ–‡å¿ƒè·¯å››æ®µ81è™Ÿ9æ¨“ä¹‹2<br>
            Fax:(04)2295-5833
          </div>
          <div class="contact-section">
            ã€é«˜é›„ã€‘æœå‹™å°ˆç·š 02-35182885<br>
            é«˜é›„å¸‚å‰é®å€ä¸­å±±äºŒè·¯91è™Ÿ8æ¨“ä¹‹9<br>
            Fax:(07)535-0099
          </div>
        </div>
      </div>
    </div>

    <form id="serviceForm">
      <!-- å°ˆæ¡ˆä»£è™Ÿ/CRMå®‰è£å–®è™Ÿ -->
      <div class="form-grid">
        <div class="form-row">
          <div class="form-cell label">å°ˆæ¡ˆä»£è™Ÿ</div>
          <div class="form-cell input"><input type="text" id="projectCode"></div>
          <div class="form-cell label">CRMå®‰è£å–®è™Ÿ</div>
          <div class="form-cell input"><input type="text" id="crmInstall"></div>
        </div>
        <div class="form-row">
          <div class="form-cell label">å«ä¿®å–®è™Ÿ</div>
          <div class="form-cell input"><input type="text" id="repairNo"></div>
          <div class="form-cell label">CRMç¶­ä¿®å–®è™Ÿ</div>
          <div class="form-cell input"><input type="text" id="crmRepair"></div>
        </div>
        <div class="form-row">
          <div class="form-cell label">å®¢æˆ¶åç¨±</div>
          <div class="form-cell input" colspan="3"><input type="text" id="customerName"></div>
        </div>
        <div class="form-row no-print">
          <div class="form-cell label">EMAIL</div>
          <div class="form-cell input" colspan="3"><input type="email" id="email"></div>
        </div>
        <div class="form-row">
          <div class="form-cell label">åœ°å€</div>
          <div class="form-cell input" colspan="3"><input type="text" id="address"></div>
        </div>
        <div class="form-row">
          <div class="form-cell label">é€£çµ¡äºº</div>
          <div class="form-cell input"><input type="text" id="contactPerson"></div>
          <div class="form-cell label">é›»è©±</div>
          <div class="form-cell input"><input type="text" id="phone"></div>
        </div>
        <div class="form-row">
          <div class="form-cell label">æœå‹™æ—¥æœŸ</div>
          <div class="form-cell input"><input type="date" id="serviceDate"></div>
          <div class="form-cell label">åˆ°é”æ™‚é–“</div>
          <div class="form-cell input"><input type="time" id="arrival"></div>
          <div class="form-cell label">çµæŸæ™‚é–“</div>
          <div class="form-cell input"><input type="time" id="finish"></div>
        </div>
      </div>

      <!-- æœå‹™æ–¹å¼ -->
      <div class="section-title">æœå‹™æ–¹å¼</div>
      <div class="section-content">
        <div class="service-methods">
          <label class="checkbox-group"><input type="checkbox">å ´å‹˜</label>
          <label class="checkbox-group"><input type="checkbox">POC</label>
          <label class="checkbox-group"><input type="checkbox">ç°¡å ±</label>
          <label class="checkbox-group"><input type="checkbox">å®‰è£</label>
          <label class="checkbox-group"><input type="checkbox">é©—æ”¶</label>
          <label class="checkbox-group"><input type="checkbox">æª¢ä¿®</label>
          <label class="checkbox-group"><input type="checkbox">äº¤è²¨</label>
          <label class="checkbox-group"><input type="checkbox">å®¢æˆ¶éœ€æ±‚è¨ªè«‡</label>
          <label class="checkbox-group"><input type="checkbox">DEMOç”¢å“å±•ç¤º</label>
          <label class="checkbox-group"><input type="checkbox">æ•™è‚²è¨“ç·´</label>
          <label class="checkbox-group"><input type="checkbox">ç§»æ©Ÿæœå‹™</label>
          <label class="checkbox-group"><input type="checkbox">æœƒè­°æ”¯æ´</label>
          <label class="checkbox-group"><input type="checkbox">å…¶ä»–</label>
        </div>
      </div>

      <!-- æœå‹™ç”¢å“ -->
      <div class="section-title">æœå‹™ç”¢å“</div>
      <div class="section-content">
        <table class="product-table">
          <thead>
            <tr><th>å» ç‰Œ</th><th>å‹è™Ÿ</th><th>ç‰ˆæœ¬</th><th>åºè™Ÿ</th></tr>
          </thead>
          <tbody>
            <tr><td><input></td><td><input></td><td><input></td><td><input></td></tr>
            <tr><td><input></td><td><input></td><td><input></td><td><input></td></tr>
            <tr><td><input></td><td><input></td><td><input></td><td><input></td></tr>
          </tbody>
        </table>
      </div>

      <!-- æœå‹™å…§å®¹ -->
      <div class="section-title">æœå‹™å…§å®¹</div>
      <div class="section-content"><textarea rows="4"></textarea></div>

      <!-- å®¢æˆ¶æ„è¦‹ -->
      <div class="section-title">å®¢æˆ¶æ„è¦‹</div>
      <div class="section-content"><textarea rows="4"></textarea></div>

      <!-- ç°½åå€ -->
      <div class="signature-section">
        <div class="signature-row">
          <div class="signature-box">
            ä¸»ç®¡ç°½å
            <canvas class="signature-canvas" id="managerSignature"></canvas>
            <div class="signature-controls no-print"><button type="button" class="clear-btn" onclick="clearSignature(managerPad)">æ¸…é™¤</button></div>
          </div>
          <div class="signature-box">
            å·¥ç¨‹å¸«ç°½å
            <canvas class="signature-canvas" id="engineerSignature"></canvas>
            <div class="signature-controls no-print"><button type="button" class="clear-btn" onclick="clearSignature(engineerPad)">æ¸…é™¤</button></div>
          </div>
          <div class="signature-box">
            å®¢æˆ¶ç°½å
            <canvas class="signature-canvas" id="customerSignature"></canvas>
            <div class="signature-controls no-print"><button type="button" class="clear-btn" onclick="clearSignature(customerPad)">æ¸…é™¤</button></div>
          </div>
        </div>
      </div>

      <!-- è²»ç”¨ç”³è«‹ -->
      <div class="section-title">è²»ç”¨ç”³è«‹ï¼š(ä»¥ä¸‹ç”±å·¥ç¨‹å¸«æ”¶å›å–®æ“šå¾Œå¡«å¯«ç”³è«‹)</div>
      <div class="section-content">
        <div class="expense-grid">
          <div class="expense-item"><label>é‡Œç¨‹ (KM)</label><input></div>
          <div class="expense-item"><label>å‡ºç™¼åœ°é»</label><input></div>
          <div class="expense-item"><label>è¨ˆç¨‹è»Šè³‡</label><input></div>
          <div class="expense-item"><label>åœè»Šè²»</label><input></div>
          <div class="expense-item"><label>eTag</label><input></div>
          <div class="expense-item"><label>å¤§çœ¾é‹è¼¸</label><input></div>
          <div class="expense-item"><label>å…¶ä»–</label><input></div>
        </div>
      </div>
    </form>

    <div class="copy-info">
      ç™½è¯ï¼šå·¥ç¨‹å¸«éƒ¨é–€ã€€ç´…è¯ï¼šè²¡å‹™éƒ¨ï¼ˆè«‹æ¬¾ç”¨ï¼‰ã€€é»ƒè¯ï¼šå®¢æˆ¶æ”¶åŸ·
    </div>

    <div class="submit-section no-print">
      <button type="button" class="submit-btn" onclick="generatePDF()">ğŸ“„ ç”¢ç”ŸPDFä¸¦é€å‡ºEMAIL</button>
    </div>
  </div>

  <script>
    let managerPad, engineerPad, customerPad;
    window.onload = function() {
      managerPad = new SignaturePad(document.getElementById('managerSignature'));
      engineerPad = new SignaturePad(document.getElementById('engineerSignature'));
      customerPad = new SignaturePad(document.getElementById('customerSignature'));
    }
    function clearSignature(pad) { pad.clear(); }

    async function generatePDF() {
      const element = document.getElementById('pdfContent');
      const canvas = await html2canvas(element, { scale:2 });
      const imgData = canvas.toDataURL('image/png');
      const pdf = new jspdf.jsPDF('p','mm','a4');
      const pdfW = pdf.internal.pageSize.getWidth();
      const pdfH = pdf.internal.pageSize.getHeight();
      pdf.addImage(imgData,'PNG',0,0,pdfW,pdfH);
      pdf.save('service-record.pdf');
    }
  </script>
</body>
</html>
